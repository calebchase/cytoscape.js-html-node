!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("cytoscape-html-node",[],e):"object"==typeof exports?exports["cytoscape-html-node"]=e():t["cytoscape-html-node"]=e()}(self,(function(){return(()=>{var t={849:(t,e,o)=>{var n,i,a,r;i=function(){function t(t,e,o){var n=t.node,i=t.position,a=void 0===i?null:i,r=t.data,s=void 0===r?null:r;this.updateParams(e),this._node=n,this.initStyles(e.cssClass),s&&this.updateData(s,o),a&&this.updatePosition(a,e)}return t.prototype.updateParams=function(t){var e=t.tpl,o=void 0===e?function(){return""}:e,n=(t.cssClass,t.halign),i=void 0===n?"center":n,a=t.valign,r=void 0===a?"center":a,s=t.halignBox,l=void 0===s?"center":s,d=t.valignBox,c=void 0===d?"center":d,p={top:-.5,left:-.5,center:0,right:.5,bottom:.5};this._align=[p[i],p[r],100*(p[l]-.5),100*(p[c]-.5)],this.tpl=o},t.prototype.updateData=function(t,e){for(;this._node.firstChild;)this._node.removeChild(this._node.firstChild);for(var o=(new DOMParser).parseFromString(this.tpl(t),"text/html").body.children,n=0;n<o.length;++n){var i=o[n];this._node.appendChild(i),e.nodes(`#${i.id.split(":")[1]}`)}},t.prototype.getNode=function(){return this._node},t.prototype.updatePosition=function(t,e){this._renderPosition(t,e)},t.prototype.initStyles=function(t){this._node.style.position="absolute",t&&t.length&&this._node.classList.add(t)},t.prototype._renderPosition=function(t,e){let o=e.staticZoomLevel||e[0]?.staticZoomLevel||1;var n=this._position,i=t.x*o+this._align[0]*t.w,a=t.y*o+this._align[1]*t.h;if(!n||n[0]!==i||n[1]!==a){this._position=[i,a];var r="translate("+this._align[2]+"%,"+this._align[3]+"%) translate("+i.toFixed(2)+"px,"+a.toFixed(2)+"px) ",s=this._node.style;s.webkitTransform=r,s.msTransform=r,s.transform=r}},t}(),a=function(){function t(t){this._node=t,this._elements={}}return t.prototype.addOrUpdateElem=function(t,e,o,n){void 0===o&&(o={});var a=this._elements[t];if(a)a.updateParams(e),a.updateData(o.data,n),a.updatePosition(o.position,e);else{var r=document.createElement("div"),s=new MutationObserver((function(t){if(document.contains(r)){let t=n.nodes(`#${r.children[0].id.split(":")[1]}`);t.data("htmlNode",r);try{t.style({width:r.offsetWidth/(e.staticZoomLevel||1),height:r.offsetHeight/(e.staticZoomLevel||1)})}catch(t){console.warn("cytoscape.js-html-node: unable to create html label",t)}s.disconnect()}}));s.observe(document,{attributes:!1,childList:!0,characterData:!1,subtree:!0}),this._elements[t]=new i({node:r,data:o.data,position:o.position},e,n),this._node.appendChild(r)}},t.prototype.removeElemById=function(t){this._elements[t]&&(this._node.removeChild(this._elements[t].getNode()),delete this._elements[t])},t.prototype.updateElemPosition=function(t,e,o){var n=this._elements[t];n&&n.updatePosition(e,o)},t.prototype.updateZoom=function(t,e){let o=e[0].staticZoomLevel;var n=t.pan,i=t.zoom,a=t.cy,r="translate("+n.x+"px,"+n.y+"px) scale("+i/(o||1)+")",s=this._node.style;let l=this._node.children;for(const t in l){let e=l[t].firstChild?.id,n=l[t].firstChild;if(null!=e&&0!=n.parentElement.offsetHeight&&0!=n.parentElement.offsetWidth){let t=e.substring("htmlLabel:".length),l=a.nodes(`[id ='${t}']`),d=l.renderedBoundingBox();null!=o&&i>o?(this._node.classList.add("html-node-notransition"),n.classList.add("html-node-notransition"),n.parentElement.classList.add("html-node-notransition"),l.style("width",n.parentElement.offsetWidth/i),l.style("height",n.parentElement.offsetHeight/i),n.parentElement.style.top=d.y1,n.parentElement.style.left=d.x1):(this._node.classList.remove("html-node-notransition"),this._node.offsetHeight,n.classList.remove("html-node-notransition"),n.offsetHeight,n.parentElement.classList.remove("html-node-notransition"),n.parentElement.offsetHeight,l.style("width",n.parentElement.offsetWidth/(o||1)),l.style("height",n.parentElement.offsetHeight/(o||1)),n.parentElement.style.top=0,n.parentElement.style.left=0,s.webkitTransform=r,s.msTransform=r,s.transform=r,s.webkitTransformOrigin=origin,s.msTransformOrigin=origin,s.transformOrigin=origin)}}},t.prototype.setNode=!1,t.prototype.updatePan=function(e,o){var n=e.pan,i=e.zoom,a="translate("+n.x+"px,"+n.y+"px) scale("+i/(o[0].staticZoomLevel||1)+")",r=this._node.style,s="top left";(0==t.prototype.setNode||null==o[0].staticZoomLevel||i<o[0].staticZoomLevel)&&(t.prototype.setNode=!0,r.webkitTransform=a,r.msTransform=a,r.transform=a,r.webkitTransformOrigin=s,r.msTransformOrigin=s,r.transformOrigin=s)},t}(),r=function(t){t&&t("core","nodeHtmlLabel",(function(t,e){return function(t,e,o){t.zoom(),staticZoomLevel=e[0].staticZoomLevel||1;var n=e&&"object"==typeof e?e:[],i=function(){var e=t.container(),n=document.createElement("div"),i=e.querySelector("canvas"),r=e.querySelector("[class^='cy-node-html']");r&&i.parentNode.removeChild(r);var s=n.style;return s.position="absolute",s["z-index"]=10,s.width="500px",s.margin="0px",s.padding="0px",s.border="0px",s.outline="0px",s.outline="0px",o&&!0!==o.enablePointerEvents&&(s["pointer-events"]="none"),i.parentNode.appendChild(n),new a(n)}();return t.one("render",(function(o){var a;a=o.cy,n.forEach((function(e){a.elements(e.query).forEach((function(o){o.isNode()&&i.addOrUpdateElem(o.id(),e,{position:s(o),data:o.data()},t)}))})),function(t,e){var o=t.cy;i.updatePan({pan:o.pan(),zoom:o.zoom()},e)}(o,e),r(o)})),t.on("add",(function(e){var o=e.target,a=function(t,e){if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var o,n=t.length>>>0,i=arguments[1],a=0;a<n;a++)if(o=t[a],e.call(i,o,a,t))return o}(n.slice().reverse(),(function(t){return o.is(t.query)}));a&&i.addOrUpdateElem(o.id(),a,{position:s(o),data:o.data()},t)})),t.on("layoutstop",(t=>{!function(t,e){var o=t.cy;n.forEach((function(t){o.elements(t.query).forEach((function(t){t.isNode()&&i.updateElemPosition(t.id(),s(t),e)}))}))}(t,e)})),t.on("remove",(function(t){i.removeElemById(t.target.id())})),t.on("zoom pan drag render",(t=>{r(t)})),t.on("position bounds",(t=>{!function(t,e){i.updateElemPosition(t.target.id(),s(t.target),e)}(t,e)})),t;function r(t){var o=t.cy;i.updateZoom({pan:o.pan(),zoom:o.zoom(),cy:o},e)}function s(t){return{w:t.width(),h:t.height(),x:t.position("x"),y:t.position("y")}}}(this,t,e)}))},t.exports?t.exports=function(t){r(t)}:void 0===(n=function(){return r}.call(e,o,e,t))||(t.exports=n),"undefined"!=typeof cytoscape&&r(cytoscape)},358:(t,e,o)=>{"use strict";function n(){function t(t,e,o,n){let a=t.zoom();for(let r=0;r<e.length;r++)if(a>=e[r].zoomRange[0]&&a<e[r].zoomRange[1])return e.htmlSet=!0,i(t,e[r].template,o,n),e[r].zoomRange}function e(t,e){let o;return e.html.replaceAll(/#{.*?}/g,(e=>(o=e.substring("#{data.".length,e.length-1),t[o])))}function n(t,o,n){t.nodes(n).forEach((function(t){t.data("htmlNode")&&(t.data("htmlNode").innerHTML=e(t.data(),o))}))}function i(t,o,n,i){t.nodeHtmlLabel([{query:n,halign:"center",valign:"center",halignBox:"center",valignBox:"center",cssClass:o.cssClass,staticZoomLevel:i,tpl:t=>e(t,o)}])}function a(t,e){let o=t.elements(e),n=o.length;for(let t=0;t<n;t++)try{if(null!=o[t].data("htmlNode"))return void(o[t].data("htmlNode").parentElement.style.visibility="hidden")}catch{console.warn("cytoscape.js-html-node: unable to hide html")}}function r(t,e){let o=t.elements(e),n=o.length;for(let t=0;t<n;t++)try{if(null!=o[t].data("htmlNode"))return void(o[t].data("htmlNode").parentElement.style.visibility="visible")}catch{console.warn("cytoscape.js-html-node: unable to show html")}}function s(e,o,i,s,l){let d,c=t(e,o,i,l),p=o[0].zoomRange[0],m=!1,f=!1;e.on("add",i,(function(t){setTimeout((function(){let i=d;f&&null!=s?(e.batch((()=>{t.target.addClass(s.alt)})),a(e,`node#${t.target.id()}`)):null!=s&&(e.batch((()=>{t.target.addClass(s.base)})),null!=o[i]&&n(e,o[i].template,`node#${t.target.id()}`))}),0)})),e.on("zoom",(function(h){let u=e.zoom();if(u<p&&!m)a(e,i),m=!0,c=[0,o[0].zoomRange[0]],null!=s&&e.batch((()=>{e.$(i).addClass(s.alt),e.$(i).removeClass(s.base)})),f=!0;else if(u<c[0]||u>c[1])for(d=0;d<o.length;d++)if(u>o[d].zoomRange[0]&&u<o[d].zoomRange[1]){n(e,o[d].template,i),c=o[d].zoomRange,f&&(null!=s&&e.batch((()=>{e.$(i).removeClass(s.alt),e.$(i).addClass(s.base)})),f=!1,r(e,i),1!=o.htmlSet&&(t(e,o,i,l),o.htmlSet=!0)),m=!1;break}})),e.emit("zoom")}return{createHtmlNode:function(t,e,n){try{e.__proto__.nodeHtmlLabel||o(849)(t);for(let t in n)s(e,n[t].template,n[t].query,n[t].nodeStyle,n[t].staticZoomLevel)}catch(t){console.warn("cytoscape.js-html-node: ",t)}}}}function i(t){t?t("core","htmlnode",n):console.warn("Attempt to register cytoscape-stickynote with invalid cytoscape instance!")}o.r(e),o.d(e,{register:()=>i}),"undefined"!=typeof cytoscape&&i(cytoscape)}},e={};function o(n){if(e[n])return e[n].exports;var i=e[n]={exports:{}};return t[n](i,i.exports,o),i.exports}return o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o(358)})()}));