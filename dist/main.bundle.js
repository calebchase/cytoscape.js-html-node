!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("cytoscape-html-node",[],e):"object"==typeof exports?exports["cytoscape-html-node"]=e():t["cytoscape-html-node"]=e()}(self,(function(){return(()=>{var t={849:(t,e,n)=>{var o;!function(){"use strict";var i=function(){function t(t,e,n){var o=t.node,i=t.position,r=void 0===i?null:i,a=t.data,l=void 0===a?null:a;this.updateParams(e),this._node=o,this.initStyles(e.cssClass),l&&this.updateData(l,n),r&&this.updatePosition(r)}return t.prototype.updateParams=function(t){var e=t.tpl,n=void 0===e?function(){return""}:e,o=(t.cssClass,t.halign),i=void 0===o?"center":o,r=t.valign,a=void 0===r?"center":r,l=t.halignBox,s=void 0===l?"center":l,d=t.valignBox,c=void 0===d?"center":d,p={top:-.5,left:-.5,center:0,right:.5,bottom:.5};this._align=[p[i],p[a],100*(p[s]-.5),100*(p[c]-.5)],this.tpl=n},t.prototype.updateData=function(t,e){for(;this._node.firstChild;)this._node.removeChild(this._node.firstChild);for(var n=(new DOMParser).parseFromString(this.tpl(t),"text/html").body.children,o=0;o<n.length;++o){var i=n[o];this._node.appendChild(i);let t=e.nodes(`#${i.id.split(":")[1]}`);t.data("htmlNode",i),t.style({width:t.data("htmlNode").parentElement.offsetWidth,height:t.data("htmlNode").parentElement.offsetHeight})}},t.prototype.getNode=function(){return this._node},t.prototype.updatePosition=function(t){this._renderPosition(t)},t.prototype.initStyles=function(t){this._node.style.position="absolute",t&&t.length&&this._node.classList.add(t)},t.prototype._renderPosition=function(t){var e=this._position,n=t.x+this._align[0]*t.w,o=t.y+this._align[1]*t.h;if(!e||e[0]!==n||e[1]!==o){this._position=[n,o];var i="translate("+this._align[2]+"%,"+this._align[3]+"%) translate("+n.toFixed(2)+"px,"+o.toFixed(2)+"px) ",r=this._node.style;r.webkitTransform=i,r.msTransform=i,r.transform=i}},t}(),r=function(){function t(t){this._node=t,this._elements={}}return t.prototype.addOrUpdateElem=function(t,e,n,o){void 0===n&&(n={});var r=this._elements[t];if(r)r.updateParams(e),r.updateData(n.data,o),r.updatePosition(n.position);else{var a=document.createElement("div");this._node.appendChild(a),this._elements[t]=new i({node:a,data:n.data,position:n.position},e,o)}},t.prototype.removeElemById=function(t){this._elements[t]&&(this._node.removeChild(this._elements[t].getNode()),delete this._elements[t])},t.prototype.updateElemPosition=function(t,e){var n=this._elements[t];n&&n.updatePosition(e)},t.prototype.updatePanZoom=function(t){var e=t.pan,n=t.zoom,o="translate("+e.x+"px,"+e.y+"px) scale("+n+")",i=this._node.style,r="top left";i.webkitTransform=o,i.msTransform=o,i.transform=o,i.webkitTransformOrigin=r,i.msTransformOrigin=r,i.transformOrigin=r},t}();var a=function(t){t&&t("core","nodeHtmlLabel",(function(t,e){return function(t,e,n){var o=e&&"object"==typeof e?e:[],i=function(){var e=t.container(),o=document.createElement("div"),i=e.querySelector("canvas"),a=e.querySelector("[class^='cy-node-html']");a&&i.parentNode.removeChild(a);var l=o.style;return l.position="absolute",l["z-index"]=10,l.width="500px",l.margin="0px",l.padding="0px",l.border="0px",l.outline="0px",l.outline="0px",n&&!0!==n.enablePointerEvents&&(l["pointer-events"]="none"),i.parentNode.appendChild(o),new r(o)}();return t.one("render",(function(e){var n;n=e.cy,o.forEach((function(e){n.elements(e.query).forEach((function(n){n.isNode()&&i.addOrUpdateElem(n.id(),e,{position:l(n),data:n.data()},t)}))})),a(e)})),t.on("add",(function(e){var n=e.target,r=function(t,e){if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var n,o=t.length>>>0,i=arguments[1],r=0;r<o;r++)if(n=t[r],e.call(i,n,r,t))return n}(o.slice().reverse(),(function(t){return n.is(t.query)}));r&&i.addOrUpdateElem(n.id(),r,{position:l(n),data:n.data()},t)})),t.on("layoutstop",(function(t){var e=t.cy;o.forEach((function(t){e.elements(t.query).forEach((function(t){t.isNode()&&i.updateElemPosition(t.id(),l(t))}))}))})),t.on("remove",(function(t){i.removeElemById(t.target.id())})),t.on("pan zoom",a),t.on("position bounds",(function(t){i.updateElemPosition(t.target.id(),l(t.target))})),t;function a(t){var e=t.cy;i.updatePanZoom({pan:e.pan(),zoom:e.zoom()})}function l(t){return{w:t.width(),h:t.height(),x:t.position("x"),y:t.position("y")}}}(this,t,e)}))};t.exports?t.exports=function(t){a(t)}:void 0===(o=function(){return a}.call(e,n,e,t))||(t.exports=o),"undefined"!=typeof cytoscape&&a(cytoscape)}()},358:(t,e,n)=>{"use strict";function o(){function t(t,e,n){let o=t.zoom();for(let r=0;r<e.length;r++)if(o>=e[r].zoomRange[0]&&o<e[r].zoomRange[1])return e[r].htmlSet=!0,i(t,e[r].template,n),e[r].zoomRange}function e(t,e){let n;return e.html.replaceAll(/#{.*?}/g,(e=>(n=e.substring("#{data.".length,e.length-1),t[n])))}function o(t,n,o){t.nodes(o).forEach((function(t){t.data("htmlNode")&&(t.data("htmlNode").innerHTML=e(t.data(),n));let o=document.getElementById(`htmlLabel:${t.id()}`);null!=o&&(o.innerHTML=e(t.data(),n))}))}function i(t,n,o){t.nodeHtmlLabel([{query:o,halign:"center",valign:"center",halignBox:"center",valignBox:"center",cssClass:n.cssClass,tpl:t=>e(t,n)}])}function r(t){let e=document.getElementById(`htmlLabel:${t}`);return null!=e&&(e.parentElement.parentElement.style.visibility="hidden",!0)}function a(t){let e=document.getElementById(`htmlLabel:${t}`);return null!=e&&(e.parentElement.parentElement.style.visibility="visible",!0)}function l(t,e){let n=t.elements(e),o=n.length,i=!1;for(let t=0;t<o;t++)if(i=a(n[t].id()),i)return}function s(e,n,i){let a,s=t(e,n,i),d=n[0].zoomRange[0],c=!1,p=!1,u=new Set;e.on("add",i,(function(t){let i=a;p?e.batch((()=>{t.target.addClass("htmlNodeAltStyle")})):t.target.addClass("htmlNodeBaseStyle"),e.on("render",(function(){!function(t,e){0!=e.size?function(t,e){e.forEach((t=>{e.delete(t)}))}(0,e):t.removeListener("render a")}(e,u),null!=n[i]&&o(e,n[a].template,`node#${t.target.id()}`)})),null!=n[i]&&o(e,n[a].template,`node#${t.target.id()}`)})),e.on("zoom",(function(u){let m=e.zoom();if(m<d&&!c)!function(t,e){let n=t.elements(e),o=n.length,i=!1;for(let t=0;t<o;t++)if(i=r(n[t].id()),i)return}(e,i),c=!0,s=[0,n[0].zoomRange[0]],e.batch((()=>{e.$(i).addClass("htmlNodeAltStyle"),e.$(i).removeClass("htmlNodeBaseStyle")})),p=!0;else if(m<s[0]||m>s[1])for(console.log("here"),a=0;a<n.length;a++)if(m>n[a].zoomRange[0]&&m<n[a].zoomRange[1]){o(e,n[a].template,i),s=n[a].zoomRange,p&&(e.batch((()=>{e.$(i).removeClass("htmlNodeAltStyle"),e.$(i).addClass("htmlNodeBaseStyle")})),p=!1,l(e,i),1!=n[a].htmlSet&&(t(e,n,i),n[a].htmlSet=!0)),c=!1;break}})),e.emit("zoom")}return{createHtmlNode:function(t,e,o){try{if(!e.__proto__.nodeHtmlLabel){n(849)(t);for(let t in o)s(e,o[t].template,o[t].query)}}catch{console.warn("cytoscape.js-html-node: multiple instances attempted to be called")}}}}function i(t){t?t("core","htmlnode",o):console.warn("Attempt to register cytoscape-stickynote with invalid cytoscape instance!")}n.r(e),n.d(e,{register:()=>i}),"undefined"!=typeof cytoscape&&i(cytoscape)}},e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={exports:{}};return t[o](i,i.exports,n),i.exports}return n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(358)})()}));