!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("cytoscape-html-node",[],e):"object"==typeof exports?exports["cytoscape-html-node"]=e():t["cytoscape-html-node"]=e()}(self,(function(){return(()=>{var t={849:(t,e,o)=>{var n;!function(){"use strict";var i=function(){function t(t,e,o){var n=t.node,i=t.position,a=void 0===i?null:i,r=t.data,s=void 0===r?null:r;this.updateParams(e),this._node=n,this.initStyles(e.cssClass),s&&this.updateData(s,o),a&&this.updatePosition(a)}return t.prototype.updateParams=function(t){var e=t.tpl,o=void 0===e?function(){return""}:e,n=(t.cssClass,t.halign),i=void 0===n?"center":n,a=t.valign,r=void 0===a?"center":a,s=t.halignBox,l=void 0===s?"center":s,d=t.valignBox,c=void 0===d?"center":d,u={top:-.5,left:-.5,center:0,right:.5,bottom:.5};this._align=[u[i],u[r],100*(u[l]-.5),100*(u[c]-.5)],this.tpl=o},t.prototype.updateData=function(t,e){for(;this._node.firstChild;)this._node.removeChild(this._node.firstChild);for(var o=(new DOMParser).parseFromString(this.tpl(t),"text/html").body.children,n=0;n<o.length;++n){var i=o[n];this._node.appendChild(i),e.nodes(`#${i.id.split(":")[1]}`)}},t.prototype.getNode=function(){return this._node},t.prototype.updatePosition=function(t){this._renderPosition(t)},t.prototype.initStyles=function(t){this._node.style.position="absolute",t&&t.length&&this._node.classList.add(t)},t.prototype._renderPosition=function(t){var e=this._position,o=t.x+this._align[0]*t.w,n=t.y+this._align[1]*t.h;if(!e||e[0]!==o||e[1]!==n){this._position=[o,n];var i="translate("+this._align[2]+"%,"+this._align[3]+"%) translate("+o.toFixed(2)+"px,"+n.toFixed(2)+"px) ",a=this._node.style;a.webkitTransform=i,a.msTransform=i,a.transform=i}},t}(),a=function(){function t(t){this._node=t,this._elements={}}return t.prototype.addOrUpdateElem=function(t,e,o,n){void 0===o&&(o={});var a=this._elements[t];if(a)a.updateParams(e),a.updateData(o.data,n),a.updatePosition(o.position);else{var r=document.createElement("div"),s=new MutationObserver((function(t){if(document.contains(r)){let t=n.nodes(`#${r.children[0].id.split(":")[1]}`);t.data("htmlNode",r);try{t.style({width:r.offsetWidth,height:r.offsetHeight})}catch(t){console.warn("cytoscape.js-html-node: unable to create html label",t)}s.disconnect()}}));s.observe(document,{attributes:!1,childList:!0,characterData:!1,subtree:!0}),this._elements[t]=new i({node:r,data:o.data,position:o.position},e,n),this._node.appendChild(r)}},t.prototype.removeElemById=function(t){this._elements[t]&&(this._node.removeChild(this._elements[t].getNode()),delete this._elements[t])},t.prototype.updateElemPosition=function(t,e){var o=this._elements[t];o&&o.updatePosition(e)},t.prototype.updatePanZoom=function(t){var e=t.pan,o=t.zoom,n="translate("+e.x+"px,"+e.y+"px) scale("+o+")",i=this._node.style,a="top left";i.webkitTransform=n,i.msTransform=n,i.transform=n,i.webkitTransformOrigin=a,i.msTransformOrigin=a,i.transformOrigin=a},t}();var r=function(t){t&&t("core","nodeHtmlLabel",(function(t,e){return function(t,e,o){var n=e&&"object"==typeof e?e:[],i=function(){var e=t.container(),n=document.createElement("div"),i=e.querySelector("canvas"),r=e.querySelector("[class^='cy-node-html']");r&&i.parentNode.removeChild(r);var s=n.style;return s.position="absolute",s["z-index"]=10,s.width="500px",s.margin="0px",s.padding="0px",s.border="0px",s.outline="0px",s.outline="0px",o&&!0!==o.enablePointerEvents&&(s["pointer-events"]="none"),i.parentNode.appendChild(n),new a(n)}();return t.one("render",(function(e){var o;o=e.cy,n.forEach((function(e){o.elements(e.query).forEach((function(o){o.isNode()&&i.addOrUpdateElem(o.id(),e,{position:s(o),data:o.data()},t)}))})),r(e)})),t.on("add",(function(e){var o=e.target,a=function(t,e){if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var o,n=t.length>>>0,i=arguments[1],a=0;a<n;a++)if(o=t[a],e.call(i,o,a,t))return o}(n.slice().reverse(),(function(t){return o.is(t.query)}));a&&i.addOrUpdateElem(o.id(),a,{position:s(o),data:o.data()},t)})),t.on("layoutstop",(function(t){var e=t.cy;n.forEach((function(t){e.elements(t.query).forEach((function(t){t.isNode()&&i.updateElemPosition(t.id(),s(t))}))}))})),t.on("remove",(function(t){i.removeElemById(t.target.id())})),t.on("pan zoom",r),t.on("position bounds",(function(t){i.updateElemPosition(t.target.id(),s(t.target))})),t;function r(t){var e=t.cy;i.updatePanZoom({pan:e.pan(),zoom:e.zoom()})}function s(t){return{w:t.width(),h:t.height(),x:t.position("x"),y:t.position("y")}}}(this,t,e)}))};t.exports?t.exports=function(t){r(t)}:void 0===(n=function(){return r}.call(e,o,e,t))||(t.exports=n),"undefined"!=typeof cytoscape&&r(cytoscape)}()},358:(t,e,o)=>{"use strict";function n(){function t(t,e,o){let n=t.zoom();for(let a=0;a<e.length;a++)if(n>=e[a].zoomRange[0]&&n<e[a].zoomRange[1])return e.htmlSet=!0,i(t,e[a].template,o),e[a].zoomRange}function e(t,e){let o;return e.html.replaceAll(/#{.*?}/g,(e=>(o=e.substring("#{data.".length,e.length-1),t[o])))}function n(t,o,n){t.nodes(n).forEach((function(t){t.data("htmlNode")&&(t.data("htmlNode").innerHTML=e(t.data(),o))}))}function i(t,o,n){t.nodeHtmlLabel([{query:n,halign:"center",valign:"center",halignBox:"center",valignBox:"center",cssClass:o.cssClass,tpl:t=>e(t,o)}])}function a(t,e){let o=t.elements(e),n=o.length;for(let t=0;t<n;t++)try{if(null!=o[t].data("htmlNode"))return void(o[t].data("htmlNode").parentElement.style.visibility="hidden")}catch{console.warn("cytoscape.js-html-node: unable to hide html")}}function r(t,e){let o=t.elements(e),n=o.length;for(let t=0;t<n;t++)try{if(null!=o[t].data("htmlNode"))return void(o[t].data("htmlNode").parentElement.style.visibility="visible")}catch{console.warn("cytoscape.js-html-node: unable to show html")}}function s(e,o,i,s){let l,d=t(e,o,i),c=o[0].zoomRange[0],u=!1,p=!1;e.on("add",i,(function(t){setTimeout((function(){let i=l;p&&null!=s?(e.batch((()=>{t.target.addClass(s.alt)})),a(e,`node#${t.target.id()}`)):null!=s&&(e.batch((()=>{t.target.addClass(s.base)})),null!=o[i]&&n(e,o[i].template,`node#${t.target.id()}`))}),0)})),e.on("zoom",(function(f){let h=e.zoom();if(h<c&&!u)a(e,i),u=!0,d=[0,o[0].zoomRange[0]],null!=s&&e.batch((()=>{e.$(i).addClass(s.alt),e.$(i).removeClass(s.base)})),p=!0;else if(h<d[0]||h>d[1])for(l=0;l<o.length;l++)if(h>o[l].zoomRange[0]&&h<o[l].zoomRange[1]){n(e,o[l].template,i),d=o[l].zoomRange,p&&(null!=s&&e.batch((()=>{e.$(i).removeClass(s.alt),e.$(i).addClass(s.base)})),p=!1,r(e,i),1!=o.htmlSet&&(t(e,o,i),o.htmlSet=!0)),u=!1;break}})),e.emit("zoom")}return{createHtmlNode:function(t,e,n){try{if(!e.__proto__.nodeHtmlLabel){o(849)(t);for(let t in n)s(e,n[t].template,n[t].query,n[t].nodeStyle)}}catch(t){console.warn("cytoscape.js-html-node: ",t)}}}}function i(t){t?t("core","htmlnode",n):console.warn("Attempt to register cytoscape-stickynote with invalid cytoscape instance!")}o.r(e),o.d(e,{register:()=>i}),"undefined"!=typeof cytoscape&&i(cytoscape)}},e={};function o(n){if(e[n])return e[n].exports;var i=e[n]={exports:{}};return t[n](i,i.exports,o),i.exports}return o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o(358)})()}));