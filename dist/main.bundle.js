!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("cytoscape-html-node",[],e):"object"==typeof exports?exports["cytoscape-html-node"]=e():t["cytoscape-html-node"]=e()}(self,(function(){return(()=>{var t={849:(t,e,n)=>{var o;!function(){"use strict";var i=function(){function t(t,e){var n=t.node,o=t.position,i=void 0===o?null:o,r=t.data,a=void 0===r?null:r;this.updateParams(e),this._node=n,this.initStyles(e.cssClass),a&&this.updateData(a),i&&this.updatePosition(i)}return t.prototype.updateParams=function(t){var e=t.tpl,n=void 0===e?function(){return""}:e,o=(t.cssClass,t.halign),i=void 0===o?"center":o,r=t.valign,a=void 0===r?"center":r,l=t.halignBox,s=void 0===l?"center":l,d=t.valignBox,c=void 0===d?"center":d,u={top:-.5,left:-.5,center:0,right:.5,bottom:.5};this._align=[u[i],u[a],100*(u[s]-.5),100*(u[c]-.5)],this.tpl=n},t.prototype.updateData=function(t){for(;this._node.firstChild;)this._node.removeChild(this._node.firstChild);for(var e=(new DOMParser).parseFromString(this.tpl(t),"text/html").body.children,n=0;n<e.length;++n){var o=e[n];this._node.appendChild(o)}},t.prototype.getNode=function(){return this._node},t.prototype.updatePosition=function(t){this._renderPosition(t)},t.prototype.initStyles=function(t){this._node.style.position="absolute",t&&t.length&&this._node.classList.add(t)},t.prototype._renderPosition=function(t){var e=this._position,n=t.x+this._align[0]*t.w,o=t.y+this._align[1]*t.h;if(!e||e[0]!==n||e[1]!==o){this._position=[n,o];var i="translate("+this._align[2]+"%,"+this._align[3]+"%) translate("+n.toFixed(2)+"px,"+o.toFixed(2)+"px) ",r=this._node.style;r.webkitTransform=i,r.msTransform=i,r.transform=i}},t}(),r=function(){function t(t){this._node=t,this._elements={}}return t.prototype.addOrUpdateElem=function(t,e,n){void 0===n&&(n={});var o=this._elements[t];if(o)o.updateParams(e),o.updateData(n.data),o.updatePosition(n.position);else{var r=document.createElement("div");this._node.appendChild(r),this._elements[t]=new i({node:r,data:n.data,position:n.position},e)}},t.prototype.removeElemById=function(t){this._elements[t]&&(this._node.removeChild(this._elements[t].getNode()),delete this._elements[t])},t.prototype.updateElemPosition=function(t,e){var n=this._elements[t];n&&n.updatePosition(e)},t.prototype.updatePanZoom=function(t){var e=t.pan,n=t.zoom,o="translate("+e.x+"px,"+e.y+"px) scale("+n+")",i=this._node.style,r="top left";i.webkitTransform=o,i.msTransform=o,i.transform=o,i.webkitTransformOrigin=r,i.msTransformOrigin=r,i.transformOrigin=r},t}();function a(t,e,n){var o=e&&"object"==typeof e?e:[],i=function(){var e=t.container(),o=document.createElement("div"),i=e.querySelector("canvas"),a=e.querySelector("[class^='cy-node-html']");a&&i.parentNode.removeChild(a);var l=o.style;return l.position="absolute",l["z-index"]=10,l.width="500px",l.margin="0px",l.padding="0px",l.border="0px",l.outline="0px",l.outline="0px",n&&!0!==n.enablePointerEvents&&(l["pointer-events"]="none"),i.parentNode.appendChild(o),new r(o)}();return t.one("render",(function(t){!function(t){var e=t.cy;o.forEach((function(t){e.elements(t.query).forEach((function(e){e.isNode()&&i.addOrUpdateElem(e.id(),t,{position:l(e),data:e.data()})}))}))}(t),a(t)})),t.on("add",(function(t){var e=t.target,n=function(t,e){if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var n,o=t.length>>>0,i=arguments[1],r=0;r<o;r++)if(n=t[r],e.call(i,n,r,t))return n}(o.slice().reverse(),(function(t){return e.is(t.query)}));n&&i.addOrUpdateElem(e.id(),n,{position:l(e),data:e.data()})})),t.on("layoutstop",(function(t){var e=t.cy;o.forEach((function(t){e.elements(t.query).forEach((function(t){t.isNode()&&i.updateElemPosition(t.id(),l(t))}))}))})),t.on("remove",(function(t){i.removeElemById(t.target.id())})),t.on("pan zoom",a),t.on("position bounds",(function(t){i.updateElemPosition(t.target.id(),l(t.target))})),t;function a(t){var e=t.cy;i.updatePanZoom({pan:e.pan(),zoom:e.zoom()})}function l(t){return{w:t.width(),h:t.height(),x:t.position("x"),y:t.position("y")}}}var l=function(t){t&&t("core","nodeHtmlLabel",(function(t,e){return a(this,t,e)}))};t.exports?t.exports=function(t){l(t)}:void 0===(o=function(){return l}.call(e,n,e,t))||(t.exports=o),"undefined"!=typeof cytoscape&&l(cytoscape)}()},358:(t,e,n)=>{"use strict";function o(){function t(t,e){let n,o=!1;return t.batch((function(){t.nodes(e).forEach((function(t){n=document.getElementById(`htmlLabel:${t.id()}`),null!=n&&(o=!0,t.style({width:n.parentElement.offsetWidth,height:n.parentElement.offsetHeight}))}))})),o}function e(t,e,n){let o=t.zoom();for(let i=0;i<e.length;i++)if(o>=e[i].zoomRange[0]&&o<e[i].zoomRange[1])return e[i].htmlSet=!0,r(t,e[i].template,n),e[i].zoomRange}function o(t,e){let n;return e.html.replaceAll(/#{.*?}/g,(e=>(n=e.substring("#{data.".length,e.length-1),t[n])))}function i(t,e,n){t.nodes(n).forEach((function(t){let n=document.getElementById(`htmlLabel:${t.id()}`);null!=n&&(n.innerHTML=o(t.data(),e))}))}function r(t,e,n){t.nodeHtmlLabel([{query:n,halign:"center",valign:"center",halignBox:"center",valignBox:"center",cssClass:e.cssClass,tpl:t=>o(t,e)}])}function a(t){let e=document.getElementById(`htmlLabel:${t}`);return null!=e&&(e.parentElement.parentElement.style.visibility="hidden",!0)}function l(t){let e=document.getElementById(`htmlLabel:${t}`);return null!=e&&(e.parentElement.parentElement.style.visibility="visible",!0)}function s(t,e){let n=t.elements(e),o=n.length,i=!1;for(let t=0;t<o;t++)if(i=l(n[t].id()),i)return}function d(n,o,r){let l,d=e(n,o,r),c=o[0].zoomRange[0],u=!1,p=!1,f=!1,m=new Set;n.on("add",r,(function(e){let r=l;p?n.batch((()=>{e.target.addClass("htmlNodeAltStyle")})):e.target.addClass("htmlNodeBaseStyle"),m.add(e.target.id()),n.on("render a",(function(){(function(e,n){0!=n.size?function(e,n){n.forEach((o=>{t(e,`node#${o}`)&&n.delete(o)}))}(e,n):e.removeListener("render a")})(n,m),null!=o[r]&&i(n,o[l].template,`node#${e.target.id()}`)}))})),n.on("zoom",(function(m){f||(f=t(n));let h=n.zoom();if(h<c&&!u&&(function(t,e){let n=t.elements(e),o=n.length,i=!1;for(let t=0;t<o;t++)if(i=a(n[t].id()),i)return}(n,r),u=!0,d=[0,o[0].zoomRange[0]],n.batch((()=>{n.$(r).addClass("htmlNodeAltStyle"),n.$(r).removeClass("htmlNodeBaseStyle")})),p=!0),h<d[0]||h>d[1])for(l=0;l<o.length;l++)if(h>o[l].zoomRange[0]&&h<o[l].zoomRange[1]){i(n,o[l].template,r),d=o[l].zoomRange,p&&(n.batch((()=>{n.$(r).removeClass("htmlNodeAltStyle"),n.$(r).addClass("htmlNodeBaseStyle")})),p=!1,s(n,r),1!=o[l].htmlSet&&(e(n,o,r),o[l].htmlSet=!0)),u=!1;break}})),n.emit("zoom")}return window.onload=()=>t(cy),{createHtmlNode:function(t,e,o){try{if(!e.__proto__.nodeHtmlLabel){n(849)(t);for(let t in o)d(e,o[t].template,o[t].query)}}catch{}}}}function i(t){t?t("core","htmlnode",o):console.warn("Attempt to register cytoscape-stickynote with invalid cytoscape instance!")}n.r(e),n.d(e,{register:()=>i}),"undefined"!=typeof cytoscape&&i(cytoscape)}},e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={exports:{}};return t[o](i,i.exports,n),i.exports}return n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(358)})()}));